<div class="bg-white rounded-lg p-[20px]">
  <div class="px-[40px] pb-[20px] border-b border-[#E2E2E2]">
    <div class="flex w-full">
      <button (click)="openCreateModal($event)"
        class="bg-[#E5F7D1] py-[5px] px-[20px] rounded-lg border border-[#64BC04] text-[#64BC04] cursor-pointer">
        <div class="flex items-center gap-[10px]">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M10 0C4.48615 0 0 4.48615 0 10C0 15.5138 4.48615 20 10 20C15.5138 20 20 15.5138 20 10C20 4.48615 15.5138 0 10 0ZM10 1.53846C14.6823 1.53846 18.4615 5.31769 18.4615 10C18.4615 14.6823 14.6823 18.4615 10 18.4615C5.31769 18.4615 1.53846 14.6823 1.53846 10C1.53846 5.31769 5.31769 1.53846 10 1.53846ZM9.23077 5.38462V9.23077H5.38462V10.7692H9.23077V14.6154H10.7692V10.7692H14.6154V9.23077H10.7692V5.38462H9.23077Z"
              fill="#64BC04" />
          </svg>
          <p>Nuevo registro</p>
        </div>
      </button>
    </div>
  </div>

  <div class="flex flex-col justify-center items-center px-[40px]">
    <div class="w-full rounded-lg overflow-hidden border border-[#D6DEE5]">
      <table class="w-full table-fixed">
        <thead class="bg-[#E5F7D1]">
          <tr class="text-[#64BC04]">
            <th class="w-[200px]"></th>
            <th class="w-[200px]">Fase</th>
            <th class="w-[200px]">Etapa</th>
            <th class="w-[200px]">Nivel</th>
            <th class="w-[200px]">Subetapa</th>
            <th class="w-[200px]">Subespecialidad</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let row of relations" class="border-b border-[#D6DEE5] h-[30px]">
            <td class="text-center">
              <div class="flex items-center justify-center">
                <button class="cursor-pointer" (click)="deletePhaseStageSubStageSubSpecialty(row.linkId, $event)">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                      d="M7 21C6.45 21 5.97933 20.8043 5.588 20.413C5.19667 20.0217 5.00067 19.5507 5 19V6H4V4H9V3H15V4H20V6H19V19C19 19.55 18.8043 20.021 18.413 20.413C18.0217 20.805 17.5507 21.0007 17 21H7ZM17 6H7V19H17V6ZM9 17H11V8H9V17ZM13 17H15V8H13V17Z"
                      fill="#64BC04" />
                  </svg>
                </button>
              </div>
            </td>

            <td><span [title]="row.phaseDescription"
                class="block line-clamp-1 text-ellipsis overflow-hidden text-center">{{ row.phaseDescription }}</span>
            </td>
            <td><span [title]="row.stageDescription"
                class="block line-clamp-1 text-ellipsis overflow-hidden text-center">{{ row.stageDescription ?? '-'
                }}</span></td>
            <td><span [title]="row.layerDescription"
                class="block line-clamp-1 text-ellipsis overflow-hidden text-center">{{ row.layerDescription ?? '-'
                }}</span></td>
            <td><span [title]="row.subStageDescription"
                class="block line-clamp-1 text-ellipsis overflow-hidden text-center">{{ row.subStageDescription ?? '-'
                }}</span></td>
            <td><span [title]="row.subSpecialtyDescription"
                class="block line-clamp-1 text-ellipsis overflow-hidden text-center">{{ row.subSpecialtyDescription ??
                '-' }}</span></td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="flex gap-2 mt-4 justify-around w-full border border-[#D6DEE5] rounded-lg h-[30px]">
      <span># Registros: {{ totalRecords }}</span>
      <div class="flex gap-[10px] items-center">
        <button class="cursor-pointer text-[#0086A5]" (click)="prevPage()" [disabled]="currentPage === 1">
          «
        </button>

        <button class="cursor-pointer py-1 px-2 rounded transition-colors" *ngFor="let page of pages"
          (click)="goToPage(page)" [ngClass]="{
            'bg-[#0086A5] text-white': page === currentPage,
            'text-black hover:bg-gray-100': page !== currentPage,
          }">
          {{ page }}
        </button>

        <button class="cursor-pointer text-[#0086A5]" (click)="nextPage()" [disabled]="currentPage === totalPages">
          »
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="showCreateModal" class="fixed inset-0 bg-black/40 z-50 overflow-y-auto">
    <div class="absolute inset-0" (click)="closeModal($event, 0)">
    </div>
    <div class="min-h-screen flex items-center justify-center py-10">
      <div class="bg-white w-[800px] rounded-xl shadow-xl animate-modal-in relative" (click)="$event.stopPropagation()">
        <div class="py-[15px] px-[45px] flex flex-col gap-[15px] items-center">
          <h1 class="text-2xl text-center">AGREGAR RELACIÓN</h1>
          <div class="flex justify-between w-full flex-wrap">
            <div class="flex flex-col">
              <p class="text-[#64BC04]">Fase</p>
              <select [(ngModel)]="createModalSelectedPhase"
                class="w-full pl-[15px] pr-[25px] py-[10px] border border-[#D6DEE5] rounded-xl cursor-pointer">
                <option [ngValue]="null">Seleccionar</option>
                <option *ngFor="let item of createModalShowFormData.phases" [ngValue]="item">
                  {{ item.phaseDescription }}
                </option>
              </select>
            </div>
            <div class="flex flex-col">
              <p class="text-[#64BC04]">Etapa</p>
              <select [(ngModel)]="createModalSelectedStage"
                class="w-full pl-[15px] pr-[25px] py-[10px] border border-[#D6DEE5] rounded-xl cursor-pointer">
                <option [ngValue]="null">Seleccionar</option>
                <option *ngFor="let item of createModalShowFormData.stages" [ngValue]="item">
                  {{ item.stageDescription }}
                </option>
              </select>
            </div>
            <div class="flex flex-col">
              <p class="text-[#64BC04]">Nivel</p>
              <select [(ngModel)]="createModalSelectedLayer"
                class="w-full pl-[15px] pr-[25px] py-[10px] border border-[#D6DEE5] rounded-xl cursor-pointer">
                <option [ngValue]="null">Seleccionar</option>
                <option *ngFor="let item of createModalShowFormData.layers" [ngValue]="item">
                  {{ item.layerDescription }}
                </option>
              </select>
            </div>
            <div class="flex flex-col">
              <p class="text-[#64BC04]">Subetapa</p>
              <select [(ngModel)]="createModalSelectedSubStage"
                class="w-full pl-[15px] pr-[25px] py-[10px] border border-[#D6DEE5] rounded-xl cursor-pointer">
                <option [ngValue]="null">Seleccionar</option>
                <option *ngFor="let item of createModalShowFormData.subStages" [ngValue]="item">
                  {{ item.subStageDescription }}
                </option>
              </select>
            </div>
            <div class="flex flex-col">
              <p class="text-[#64BC04]">Subespecialidad</p>
              <select [(ngModel)]="createModalSelectedSubSpecialty"
                class="w-full pl-[15px] pr-[25px] py-[10px] border border-[#D6DEE5] rounded-xl cursor-pointer">
                <option [ngValue]="null">Seleccionar</option>
                <option *ngFor="let item of createModalShowFormData.subSpecialties" [ngValue]="item">
                  {{ item.subSpecialtyDescription }}
                </option>
              </select>
            </div>
            <div class="flex flex-col jus">
              <p class="text-[#64BC04]">Estado</p>
              <select [(ngModel)]="createModalSelectedActive"
                class="w-full pl-[15px] pr-[25px] py-[10px] border border-[#D6DEE5] rounded-xl cursor-pointer">
                <option [ngValue]="true">ACTIVO</option>
                <option [ngValue]="false">INACTIVO</option>
              </select>
            </div>
          </div>

          <button (click)="saveItem()" class="w-[120px] bg-[#64BC04] py-[5px] rounded-[10px] cursor-pointer">
            <p class="text-[#ffffff] text-lg">Guardar</p>
          </button>
        </div>
        <button class="absolute top-6 right-6 cursor-pointer" (click)="closeModal($event, 1)">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M20 20L4 4M20 4L4 20" stroke="#64BC04" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
    </div>
  </div>
</div>

<div *ngIf="loader" class="loader-overlay">
  <div class="loader"></div>
</div>